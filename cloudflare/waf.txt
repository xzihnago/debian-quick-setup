# S known bots
(cf.client.bot) or (http.user_agent contains "letsencrypt" and http.request.uri.path contains "acme-challenge")

# MC large csp
#   7224    : AMAZON-AS
#   14618   : AMAZON-AES
#   16509   : AMAZON-02
#   8075    : MICROSOFT-CORP-MSN-AS-BLOCK
#   15169   : GOOGLE
#   396982  : GOOGLE-CLOUD-PLATFORM
#   37963   : ALIBABA-CN-NET
#   45102   : ALIBABA-CN-NET
#   31898   : ORACLE-BMC-31898
#   14340   : SALESFORCE
#   36351   : SOFTLAYER
#   45090   : TENCENT-NET-AP
#   132203  : TENCENT-NET-AP-CN
#   55990   : HWCSNET
#   136907  : HWCLOUDS-AS-AP
#   14061   : DIGITALOCEAN-ASN
(ip.src.asnum in {7224 14618 16509 8075 15169 396982 37963 45102 31898 14340 36351 45090 132203 55990 136907 14061})

# MC risk asn (https://github.com/O-X-L/risk-db)
(ip.src.asnum in {4 32 111 174 209 577 680 786 812 852 931 1101 1241 1764 1955 2108 2116 2119 2152 2514 2519 2561 2635 2637 2856 3209 3212 3215 3216 3243 3249 3255 3257 3269 3301 3303 3320 3326 3462 3786 4007 4134 4230 4609 4657 4685 4713 4755 4760 4766 4771 4773 4775 4788 4800 4804 4808 4812 4837 5089 5410 5430 5432 5483 5578 5650 6282 6306 6327 6391 6535 6568 6661 6697 6698 6703 6718 6724 6730 6739 6799 6805 6821 6849 6855 6878 6939 7029 7377 7506 7552 7590 7713 7738 7922 8048 8053 8075 8100 8151 8167 8304 8369 8400 8402 8412 8422 8447 8452 8492 8560 8708 8732 8763 8767 8866 8881 8899 9009 9038 9050 9105 9121 9123 9198 9260 9269 9287 9299 9304 9318 9329 9354 9381 9416 9465 9498 9541 9658 9678 9808 9829 9905 9924 9931 10029 10103 10164 10429 10439 10834 11320 11426 11776 11831 11878 12083 12182 12271 12322 12389 12392 12400 12430 12479 12494 12555 12593 12714 12735 12816 12874 12876 12975 12997 13188 13285 13332 13335 13354 14061 14080 14259 14413 14576 14618 14754 14782 14956 14987 15468 15493 15557 15598 15774 15895 15964 16010 16276 16509 17055 17222 17426 17483 17506 17514 17547 17557 17623 17625 17639 17816 17858 17971 18049 18126 18209 18403 18978 19108 19527 19711 19871 19905 20001 20016 20115 20473 20853 20870 21050 21056 21299 21334 21367 21453 21479 21769 21859 21928 22075 22363 22411 22439 22552 22612 22646 22772 22773 23158 23383 23470 23472 23674 23724 23872 23956 23969 24085 24086 24151 24309 24337 24429 24444 24547 24560 24626 24641 24651 24757 24863 24940 24955 25019 25135 25211 25227 25255 25369 25408 25490 25513 26347 26356 26496 26599 26617 27640 27699 27866 27967 28209 28210 28573 28669 28685 28773 28787 28812 29066 29075 29124 29190 29226 29518 29571 30277 30688 30722 30823 30855 31034 31042 31115 31133 31213 31261 31708 31725 31798 31863 31898 32097 32244 32475 32613 32780 33185 33363 33915 34052 34058 34065 34534 34762 34788 34878 34927 34984 35369 35568 35612 35807 35819 35916 36007 36114 36321 36351 36352 36375 36680 36884 36907 36914 36925 36947 37084 37611 37705 37963 38283 38623 38700 38753 38841 38901 39351 39486 39699 39824 39832 40021 40788 40793 40819 40861 41307 41350 41436 41564 41608 41704 41754 41822 41913 42043 42159 42237 42337 42422 42560 42610 42624 42682})
(ip.src.asnum in {42708 42910 42960 43037 43350 43357 43641 43843 44066 44395 44453 44477 44486 44631 44709 44866 45090 45102 45352 45458 45722 45753 45758 45820 45899 46606 46785 46844 47105 47544 47583 47674 47692 47890 48090 48254 48282 48693 48715 48721 48763 48781 48925 49218 49434 49505 49581 49870 50340 50360 50466 50926 51115 51167 51396 51659 51852 51973 52041 52043 52053 52073 52129 52335 52368 52468 52662 52804 52965 53205 53667 53939 54113 54290 55163 55430 55577 55653 55695 55836 55933 55960 55990 56040 56041 56044 56046 56047 56048 56202 57334 57494 57588 57746 58061 58087 58212 58224 58492 58519 59425 59441 59461 59890 60068 60223 60246 60404 60729 60781 60904 61112 61452 61854 62160 62212 62240 62371 62563 62713 62904 63023 63737 63760 63844 63949 64080 64236 131090 131386 131392 131965 132116 132203 132717 133180 133201 133398 133643 133695 134032 134599 134761 135089 135269 135377 135450 135629 135872 135905 135918 136038 136170 136258 136557 136787 136907 137409 137687 137853 137872 137951 138290 138415 138489 138608 138915 139628 140061 140293 140389 140869 141004 141294 141892 141995 142002 142367 142403 147181 148981 149060 149440 149746 150008 150623 151718 151938 152194 152530 153416 196695 196730 196797 197226 197422 197450 197540 197726 197854 197860 197922 198584 198953 198983 199058 199524 199785 199912 200000 200019 200373 200590 200651 201211 201446 201814 202098 202306 202425 202448 202496 203020 203223 203999 204428 204548 204769 204997 205016 205100 205275 205876 206092 206216 206281 206924 207083 207252 207279 207333 207566 207647 207821 207994 208046 208091 208161 208323 208677 208879 209605 209828 209854 209956 210183 210250 210403 210558 210644 210848 211029 211298 211381 211607 211619 211680 211736 211871 212238 212317 212441 212504 213613 213790 213845 214497 214503 214677 214940 214943 214967 215026 215240 215292 215439 215476 215540 215590 215599 215703 215730 215925 216071 216127 216167 262409 262450 262805 263767 263826 264496 264508 265420 265645 265761 265919 267679 267784 269712 270270 270353 272547 273173 327901 328608 394256 394303 396356 396982 397373 398101 398324 398705 398722 399486 399507 399606 399629 399646 400992 401109 401115 401116 401120})

# MC country / threat score
(not ip.src.country in {""}) or (cf.threat_score gt 10)
